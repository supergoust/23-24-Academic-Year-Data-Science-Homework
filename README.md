# 23-24-Academic-Year-Data-Science-Homework
23-24学年第二学期数据科学大作业，主要研究方向为探索重大疫情事件与民众行为的关联与影响。使用了主成分分析，线性回归，BP神经网络分析和SVM分类。此项目中的文件主要是辅助读者复现report中的图片和结果。所有基于图片和结果产生的结论均需要读者查看report报告。
## 1.写在开始使用本项目前
### 1.1使用代码的环境
笔者在本项目中所有的代码编写均在Jupyter Notebook的环境下完成。Jupyter Notebook是一个集成化的Python编写环境，无需自己手动下载安装各类的诸如numpy，pandas的python开源代码库。笔者已经将所有项目文件中的python文件集合到一个可在Jupyter Notebook中运行的文件，即：代码汇总.ipynb。读者可以用Jupyter Notebook打开此文件来运行同样的代码。
### 1.2安装Jupyter Notebook的说明
Jupyter Notebook的安装需要先完成anaconda的安装，读者可以进入：https://www.anaconda.com/download/ 来安装此软件
安装完毕后运行anaconda，在打开的应用界面的左上角找到Home页面，在页面中找到Jupyter Notebook这个子应用，下载安装它。然后就可以点击使用了。
### 1.3使用代码汇总.ipynb的说明
在打开Jupyter Notebook后，找到下载的代码汇总.ipynb的位置并左键双击运行它，即可在页面上看到所有代码。
选择其中一个代码框，并同时按下Shift键和Enter键，即可快捷运行代码，获得代码对应的结果。
### 1.4其他python的使用说明
由于笔者在编写代码的过程中没有进行安装其他代码库的过程，所以建议读者自行安装代码中使用代码库。
### 1.5开始使用本项目文件的其他提醒
最好将文件统一保存的本地运行，这样可以保证所以excel文件能被正确读取而不出其他差错。建议将Rural/Total/Urban branch中的文件分别保存的同一文件夹中，避免代码在运行过程中报错。
## 2.excel文件的说明
### 2.1不会用到的excel文件
文件中有部分excel文件在整个复现过程中不会被用到，包括：
行为负担取自于农村和城市的原数据.xlsx ；
在使用求和代码后得到的三个excel表格，分别为在文件夹have sum/Rural sum/Urban sum下的all_data_summary.xlsx
这些文件用于呈现我们在研究过程中得到的最原始资料，可供其他需要研究的读者进行其他方向的分析。
### 2.2excel筛选说明
在浏览项目中的execl文件的时候，会发现有部分数据重复。这是我们为了方便后面的用于分析的代码方便运行做的预处理，处理过程并不复杂，但是为了节省时间，我们将处理好的excel文档一并放在了项目中。以下是筛选数据前后所对应的excel表。
行为负担取自于农村和城市的原数据.xlsx--行为各项求和数据.xlsx
运行代码后得到的位于have sum文件夹下的all_data_summary.xlsx--数据.xlsx
运行代码后得到的位于Rural sum文件夹下的all_data_summary.xlsx--筛选后农村.xlsx
运行代码后得到的位于Urban sum文件夹下的all_data_summary.xlsx--筛选后城市.xlsx
## 3.开始运行代码
### 3.1行为人次总数折线图
首先我们运行 行为人次总数折线图.py 得到report中的Figure 2，在运行前记得检查代码里面第6行是否已改为本地的 行为各项求和数据.xlsx 的地址。
运行得到的结果就是与Figure 2相同的图片。
### 3.2求和
接着我们运行三次 表格求和代码.py ，注意这三次均需要对代码进行细微调整以此来保证我们能正确读取和输出数据。
第一次我们计算Total branch下的文件。首先我们将该branch下的所有文件保存到一个Total文件夹中，然后将代码的第6行更改为该文件夹的地址，直接运行。就可以得到位于have sum文件夹下的all_data_summary.xlsx。
第二次我们计算Rural branch下的文件。首先我们将该branch下的所有文件保存到一个Rural文件夹中，然后将代码的第6行更改为该文件夹的地址，然后在将第六行地址复制到第7行，然后将最后一个地址改为Rural sum。然后运行。就可以得到位于Rural sum文件夹下的all_data_summary.xlsx。
第三次我们计算Urban branch下的文件。首先我们将该branch下的所有文件保存到一个Urban文件夹中，然后将代码的第三行更改为该文件夹的地址，然后在将第6行地址复制到第七行，然后将最后一个地址改为Urban sum。然后运行。就可以得到位于Urban sum文件夹下的all_data_summary.xlsx。
### 3.3进行主成分分析
现在我们运行 主成分分析图片.py ，在运行前记得检查代码里面第6行是否已改为本地的 数据.xlsx 的地址。
然后运行 主成分分析公式.py ，在运行前记得检查代码里面第6行是否已改为本地的 数据.xlsx 的地址。
接着我们就可以得到总计11个公式，经过对图片的人工观察和筛选，我们就可以选出report中的两个公式。
### 3.4进行线性回归
现在我们运行 计算线性回归方程.py 我们就可以得出在report中的公式示例。
接着我们运行 线性回归图片.py ，在运行前记得检查代码里面第12行是否已改为本地的 数据.xlsx 的地址，以及第16行是否已改为本地的 死亡人数筛选后求和.xlsx 的地址。然后我们就可以得到report中的Figure 11和Table 12以及Table 13的数据.
### 3.5进行BP神经网络分析
接着我们运行 线性回归图片.py ，在运行前记得检查代码里面第8行是否已改为本地的 数据.xlsx 的地址，以及第9行是否已改为本地的 死亡人数筛选后求和.xlsx 的地址。然后我们就可以得到report中的Figure 14.
然后我们运行 神经网络的误差分析.py ，在运行前记得检查代码里面第8行是否已改为本地的 数据.xlsx 的地址，以及第9行是否已改为本地的 死亡人数筛选后求和.xlsx 的地址。然后我们就可以得到report中的Table 15的数据.
### 3.6进行SVM分类
接着我们运行 线性回归图片.py ，在运行前记得检查代码里面第9行是否已改为本地的 筛选后城市.xlsx 的地址，以及第10行是否已改为本地的 筛选后农村.xlsx 的地址。然后我们就可以得到report中的Figure 16和Table 17的数据.
## 4. 结语
关于本次构建的指标体系和政策评价模型，我们深知尚存诸多待完善之处。首要问题在于，指标体系备选库的指标相对不足，因此，在未来的深入研究中，我们将致力于进一步扩充和丰富指标体系的备选库。希望老师给我和我的队友高分！！！
